{"ast":null,"code":"/*\nThis file is part of web3.js.\n\nweb3.js is free software: you can redistribute it and/or modify\nit under the terms of the GNU Lesser General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nweb3.js is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU Lesser General Public License for more details.\n\nYou should have received a copy of the GNU Lesser General Public License\nalong with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport { AbiError } from 'web3-errors';\nimport { uint8ArrayConcat } from 'web3-utils'; // eslint-disable-next-line import/no-cycle\n\nimport { decodeParamFromAbiParameter, encodeNumber, encodeParamFromAbiParameter } from './index.js';\nimport { extractArrayType, isDynamic, WORD_SIZE } from '../utils.js';\nimport { decodeNumber } from './number.js';\nimport { encodeDynamicParams } from './utils.js';\nexport function encodeArray(param, values) {\n  if (!Array.isArray(values)) {\n    throw new AbiError('Expected value to be array', {\n      abi: param,\n      values\n    });\n  }\n\n  const {\n    size,\n    param: arrayItemParam\n  } = extractArrayType(param);\n  const encodedParams = values.map(v => encodeParamFromAbiParameter(arrayItemParam, v));\n  const dynamic = size === -1;\n  const dynamicItems = encodedParams.length > 0 && encodedParams[0].dynamic;\n\n  if (!dynamic && values.length !== size) {\n    throw new AbiError(\"Given arguments count doesn't match array length\", {\n      arrayLength: size,\n      argumentsLength: values.length\n    });\n  }\n\n  if (dynamic || dynamicItems) {\n    const encodingResult = encodeDynamicParams(encodedParams);\n\n    if (dynamic) {\n      const encodedLength = encodeNumber({\n        type: 'uint256',\n        name: ''\n      }, encodedParams.length).encoded;\n      return {\n        dynamic: true,\n        encoded: encodedParams.length > 0 ? uint8ArrayConcat(encodedLength, encodingResult) : encodedLength\n      };\n    }\n\n    return {\n      dynamic: true,\n      encoded: encodingResult\n    };\n  }\n\n  return {\n    dynamic: false,\n    encoded: uint8ArrayConcat(...encodedParams.map(p => p.encoded))\n  };\n}\nexport function decodeArray(param, bytes) {\n  // eslint-disable-next-line prefer-const\n  let {\n    size,\n    param: arrayItemParam\n  } = extractArrayType(param);\n  const dynamic = size === -1;\n  let consumed = 0;\n  const result = [];\n  let remaining = bytes; // dynamic array, we need to decode length\n\n  if (dynamic) {\n    const lengthResult = decodeNumber({\n      type: 'uint32',\n      name: ''\n    }, bytes);\n    size = Number(lengthResult.result);\n    consumed = lengthResult.consumed;\n    remaining = lengthResult.encoded;\n  }\n\n  const hasDynamicChild = isDynamic(arrayItemParam);\n\n  if (hasDynamicChild) {\n    // known length but dynamic child, each child is actually head element with encoded offset\n    for (let i = 0; i < size; i += 1) {\n      const offsetResult = decodeNumber({\n        type: 'uint32',\n        name: ''\n      }, remaining.subarray(i * WORD_SIZE));\n      consumed += offsetResult.consumed;\n      const decodedChildResult = decodeParamFromAbiParameter(arrayItemParam, remaining.subarray(Number(offsetResult.result)));\n      consumed += decodedChildResult.consumed;\n      result.push(decodedChildResult.result);\n    }\n\n    return {\n      result,\n      encoded: remaining.subarray(consumed),\n      consumed\n    };\n  }\n\n  for (let i = 0; i < size; i += 1) {\n    // decode static params\n    const decodedChildResult = decodeParamFromAbiParameter(arrayItemParam, bytes.subarray(consumed));\n    consumed += decodedChildResult.consumed;\n    result.push(decodedChildResult.result);\n  }\n\n  return {\n    result,\n    encoded: bytes.subarray(consumed),\n    consumed\n  };\n}","map":{"version":3,"mappings":"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","names":["AbiError","uint8ArrayConcat","decodeParamFromAbiParameter","encodeNumber","encodeParamFromAbiParameter","extractArrayType","isDynamic","WORD_SIZE","decodeNumber","encodeDynamicParams","encodeArray","param","values","Array","isArray","abi","size","arrayItemParam","encodedParams","map","v","dynamic","dynamicItems","length","arrayLength","argumentsLength","encodingResult","encodedLength","type","name","encoded","p","decodeArray","bytes","consumed","result","remaining","lengthResult","Number","hasDynamicChild","i","offsetResult","subarray","decodedChildResult","push"],"sources":["C:\\Users\\Asus\\Desktop\\todolist-blockchain\\node_modules\\web3-eth-abi\\src\\coders\\base\\array.ts"],"sourcesContent":["/*\nThis file is part of web3.js.\n\nweb3.js is free software: you can redistribute it and/or modify\nit under the terms of the GNU Lesser General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nweb3.js is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU Lesser General Public License for more details.\n\nYou should have received a copy of the GNU Lesser General Public License\nalong with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n*/\nimport { AbiError } from 'web3-errors';\nimport { AbiParameter } from 'web3-types';\nimport { uint8ArrayConcat } from 'web3-utils';\n// eslint-disable-next-line import/no-cycle\nimport { decodeParamFromAbiParameter, encodeNumber, encodeParamFromAbiParameter } from './index.js';\nimport { DecoderResult, EncoderResult } from '../types.js';\nimport { extractArrayType, isDynamic, WORD_SIZE } from '../utils.js';\nimport { decodeNumber } from './number.js';\nimport { encodeDynamicParams } from './utils.js';\n\nexport function encodeArray(param: AbiParameter, values: unknown): EncoderResult {\n\tif (!Array.isArray(values)) {\n\t\tthrow new AbiError('Expected value to be array', { abi: param, values });\n\t}\n\tconst { size, param: arrayItemParam } = extractArrayType(param);\n\tconst encodedParams = values.map(v => encodeParamFromAbiParameter(arrayItemParam, v));\n\tconst dynamic = size === -1;\n\tconst dynamicItems = encodedParams.length > 0 && encodedParams[0].dynamic;\n\tif (!dynamic && values.length !== size) {\n\t\tthrow new AbiError(\"Given arguments count doesn't match array length\", {\n\t\t\tarrayLength: size,\n\t\t\targumentsLength: values.length,\n\t\t});\n\t}\n\tif (dynamic || dynamicItems) {\n\t\tconst encodingResult = encodeDynamicParams(encodedParams);\n\t\tif (dynamic) {\n\t\t\tconst encodedLength = encodeNumber(\n\t\t\t\t{ type: 'uint256', name: '' },\n\t\t\t\tencodedParams.length,\n\t\t\t).encoded;\n\t\t\treturn {\n\t\t\t\tdynamic: true,\n\t\t\t\tencoded:\n\t\t\t\t\tencodedParams.length > 0\n\t\t\t\t\t\t? uint8ArrayConcat(encodedLength, encodingResult)\n\t\t\t\t\t\t: encodedLength,\n\t\t\t};\n\t\t}\n\t\treturn {\n\t\t\tdynamic: true,\n\t\t\tencoded: encodingResult,\n\t\t};\n\t}\n\n\treturn {\n\t\tdynamic: false,\n\t\tencoded: uint8ArrayConcat(...encodedParams.map(p => p.encoded)),\n\t};\n}\n\nexport function decodeArray(param: AbiParameter, bytes: Uint8Array): DecoderResult<unknown[]> {\n\t// eslint-disable-next-line prefer-const\n\tlet { size, param: arrayItemParam } = extractArrayType(param);\n\tconst dynamic = size === -1;\n\n\tlet consumed = 0;\n\tconst result: unknown[] = [];\n\tlet remaining = bytes;\n\t// dynamic array, we need to decode length\n\tif (dynamic) {\n\t\tconst lengthResult = decodeNumber({ type: 'uint32', name: '' }, bytes);\n\t\tsize = Number(lengthResult.result);\n\t\tconsumed = lengthResult.consumed;\n\t\tremaining = lengthResult.encoded;\n\t}\n\tconst hasDynamicChild = isDynamic(arrayItemParam);\n\tif (hasDynamicChild) {\n\t\t// known length but dynamic child, each child is actually head element with encoded offset\n\t\tfor (let i = 0; i < size; i += 1) {\n\t\t\tconst offsetResult = decodeNumber(\n\t\t\t\t{ type: 'uint32', name: '' },\n\t\t\t\tremaining.subarray(i * WORD_SIZE),\n\t\t\t);\n\t\t\tconsumed += offsetResult.consumed;\n\t\t\tconst decodedChildResult = decodeParamFromAbiParameter(\n\t\t\t\tarrayItemParam,\n\t\t\t\tremaining.subarray(Number(offsetResult.result)),\n\t\t\t);\n\t\t\tconsumed += decodedChildResult.consumed;\n\t\t\tresult.push(decodedChildResult.result);\n\t\t}\n\t\treturn {\n\t\t\tresult,\n\t\t\tencoded: remaining.subarray(consumed),\n\t\t\tconsumed,\n\t\t};\n\t}\n\n\tfor (let i = 0; i < size; i += 1) {\n\t\t// decode static params\n\t\tconst decodedChildResult = decodeParamFromAbiParameter(\n\t\t\tarrayItemParam,\n\t\t\tbytes.subarray(consumed),\n\t\t);\n\t\tconsumed += decodedChildResult.consumed;\n\t\tresult.push(decodedChildResult.result);\n\t}\n\treturn {\n\t\tresult,\n\t\tencoded: bytes.subarray(consumed),\n\t\tconsumed,\n\t};\n}\n"]},"metadata":{},"sourceType":"module"}